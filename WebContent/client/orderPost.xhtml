<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<h:head>

</h:head>

<h:body>
	<ui:composition template="/templates/layout.xhtml">
		<ui:define name="content">
			<h:form>
				<f:facet name="header">Order</f:facet>
				<h:panelGrid columns="3" cellpadding="3">
					<h:panelGroup>
						<p:panel header="Car Details">
							<h:panelGrid columns="2" cellpadding="7">

								<h:outputText value="Model" />
								<h:outputText
									value="#{selectedCarBean.car.carModel.carModelName}" id="model" />

								<h:outputText value="Type:" />
								<h:outputText value="#{selectedCarBean.car.carType.value}"
									id="type" />

								<h:outputText value="Number:" />
								<h:outputText value="#{selectedCarBean.car.carNumber}"
									id="number" />

								<h:outputText value="Year:" />
								<h:outputText value="#{selectedCarBean.car.carYear}" id="year">
									<f:convertDateTime pattern="yyyy" />
								</h:outputText>

								<h:outputText value="Price:" />
								<h:outputText value="#{selectedCarBean.car.carPrice}" id="price" />

							</h:panelGrid>

						</p:panel>
					</h:panelGroup>
					<h:panelGroup>
						<div id="arend_time_form">
							<h:form>
								<p:panel id="panel" header="Enter dates:">
									<h:panelGrid columns="3" cellpadding="5">
										<p:outputLabel for="from_time" value="From time: " />
										<p:calendar id="from_time" binding="#{fromTimeComponent}"
											value="#{orderPostBean.contract.contractDateFrom}"
											navigator="true" display="inline" required="true"
											requiredMessage="Please select start time"
											converterMessage="Invalid date" />
										<p:message for="from_time" style="color:red" />

										<p:outputLabel for="to_time" value="To time: " />
										<p:calendar id="to_time"
											value="#{orderPostBean.contract.contractDateTo}"
											navigator="true" display="inline" required="true"
											requiredMessage="Please select end time"
											converterMessage="Invalid date">
											<f:attribute name="fromTimeComponent"
												value="#{fromTimeComponent}" />
											<f:attribute name="car"
												value="#{orderPostBean.selectedCarBean.car}" />
											<!--   <f:validator validatorId="dateGapValidator"/> -->
										</p:calendar>
										<p:message for="to_time" style="color:red" />
									</h:panelGrid>
								</p:panel>

								<p:panel id="display" header="Money/term">
									<h:panelGrid columns="2">
										<p:outputLabel value="General sum:" />
										<p:outputLabel
											value="#{orderPostBean.rentDays * orderPostBean.selectedCarBean.car.carPrice}" />

										<p:outputLabel rendered="true" value="Your personal discount:" />
										<p:outputLabel rendered="true"
											value="#{orderPostBean.clientBean.selectedClient.clientDiscount}" />

										<p:outputLabel value="Total sum:" />
										<p:outputLabel
											rendered="#{orderPostBean.contract.totalPrice!=null}"
											value="#{orderPostBean.contract.totalPrice} USD" />
										<p:outputLabel
											rendered="#{orderPostBean.contract.totalPrice==null}"
											value="0.0 USD" />

									</h:panelGrid>

								</p:panel>

								<p:commandButton value="Calculate"
									action="#{orderPostBean.precalculate}" update="display, panel" />
								<p:commandButton value="Place Order"
									action="#{orderPostBean.postOrder}" onsuccess="dlg1.show();" />

								<p:dialog header="Post Order" widgetVar="dlg1">
									<h:outputText value="#{text.dialogSuccessBook}" />
								</p:dialog>

							</h:form>

						</div>
					</h:panelGroup>

				</h:panelGrid>
			</h:form>
			<h:form>
				<p:commandButton value="Cancel"
					action="/client/carView.xhtml?faces-redirect=true" ajax="false" />
			</h:form>
		</ui:define>
	</ui:composition>


</h:body>
</html>
